<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>panel models · Stochastic Frontier Analysis using Julia</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-134239283-1"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-134239283-1', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="Stochastic Frontier Analysis using Julia logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Stochastic Frontier Analysis using Julia</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home of SFrontiers.jl</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="installation.html">Installation</a></li><li><a class="tocitem" href="overview.html">Estimation Overview</a></li><li><a class="tocitem" href="ex_detail.html">A Detailed Example</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox" checked/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Other Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="ex_cross.html">cross-sectional models</a></li><li class="is-active"><a class="tocitem" href="ex_panel.html">panel models</a><ul class="internal"><li><a class="tocitem" href="#Panel-True-Fixed-Effect-Model"><span>Panel True Fixed Effect Model</span></a></li><li><a class="tocitem" href="#Panel-True-Random-Effect-Model"><span>Panel True Random Effect Model</span></a></li><li><a class="tocitem" href="#Panel-Time-Decay-Model"><span>Panel Time Decay Model</span></a></li></ul></li></ul></li><li><a class="tocitem" href="api.html">API Reference</a></li></ul></li><li><a class="tocitem" href="LICENSE.html">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li><a class="is-disabled">Other Examples</a></li><li class="is-active"><a href="ex_panel.html">panel models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="ex_panel.html">panel models</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="panel"><a class="docs-heading-anchor" href="#panel">Examples of Panel Stochastic Frontier Models</a><a id="panel-1"></a><a class="docs-heading-anchor-permalink" href="#panel" title="Permalink"></a></h1><ul><li><a href="ex_panel.html#panel">Examples of Panel Stochastic Frontier Models</a></li><ul><li><a href="ex_panel.html#Panel-True-Fixed-Effect-Model">Panel True Fixed Effect Model</a></li><ul><ul><li><a href="ex_panel.html#TFE-with-dummy-variables-([Greene-2005,-Wang-2003](@ref-literature))">TFE with dummy variables (Greene 2005, Wang 2003)</a></li><li><a href="ex_panel.html#TFE-with-skew-normal-approach-([Chen,-Schmidt,-and-Wang-2014](@ref-literature))">TFE with skew-normal approach (Chen, Schmidt, and Wang 2014)</a></li><li><a href="ex_panel.html#TFE-with-scaling-property-and-inefficiency-determinants-([Wang-and-Ho-2010](@ref-literature))">TFE with scaling property and inefficiency determinants (Wang and Ho 2010)</a></li></ul></ul><li><a href="ex_panel.html#Panel-True-Random-Effect-Model">Panel True Random Effect Model</a></li><li><a href="ex_panel.html#Panel-Time-Decay-Model">Panel Time Decay Model</a></li></ul></ul><div class="admonition is-info"><header class="admonition-header">Reminder</header><div class="admonition-body"><p>As shown in the <a href="ex_detail.html#detailedexample">A Detailed Example</a> section, <strong>SFrontiers</strong> estimates stochastic frontier models in four steps:</p><ol><li>model specification using <code>sfmodel_spec()</code>,</li><li>initial values using <code>sfmodel_init()</code> (<em>optional</em>),</li><li>maximization options (and others) using <code>sfmodel_opt()</code> (<em>optional</em>),</li><li>estimation using <code>sfmodel_fit()</code>.</li></ol><p>Here we only highlight the first step of using <code>sfmodel_spec()</code> for different models.</p></div></div><div class="admonition is-info"><header class="admonition-header">Additional Tags for Panel Model</header><div class="admonition-body"><p>In general, the panel model requires the additional tags of:</p><ul><li><code>sfpanel()</code>: the model id, which currently includes <code>TFE_CSW2014</code>， <code>TFE_WH2010</code>, <code>TRE</code>, <code>TimeDecay</code>.</li><li><code>timevar()</code>: variable of time period,</li><li><code>idvar()</code>: variable for individual identification.</li></ul></div></div><h2 id="Panel-True-Fixed-Effect-Model"><a class="docs-heading-anchor" href="#Panel-True-Fixed-Effect-Model">Panel True Fixed Effect Model</a><a id="Panel-True-Fixed-Effect-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Panel-True-Fixed-Effect-Model" title="Permalink"></a></h2><p>A general setup of this model is:</p><p class="math-container">\[\begin{aligned}
  &amp; y_{it}  = \alpha_i +  x_{it} \beta + \epsilon_{it},\\
  &amp; \epsilon_{it}  = v_{it} - u_{it},\\
  &amp; v_{it} \sim N(0, \sigma_v^2),   \quad u_{it}  \sim N^+(\mu, \sigma_u^2),
\end{aligned} \]</p><p>where <span>$\alpha_i$</span> is the time-invariant and individual-specific effect which is not directly observable. It is not the same as the inefficiency effect, the latter of which is represented by <span>$u_{it}$</span>. Here <span>$\alpha_i$</span> is assumed to be a fixed parameter which allows arbitrary correlations with <span>$x_{it}$</span>. </p><p>Greene (2005) coins the term <em>true fixed effect</em> for this setup in order to distinguish it from other panel SF models where the fixed effect has different interpretations. For instance, Schmidt and Sickles (1984) have <span>$\alpha_i$</span> in the model and is also a fixed parameter. Their model, however, does not have <span>$u_{it}$</span>. They interpret the estimated <span>$\alpha_i$</span>, after normalization, as the inefficiency effect. Thus their <span>$\alpha_i$</span> is not the kind of fixed effect in the traditional sense and could be argued as a mixture of the individual effect and the inefficiency effect. Thus, <em>true fixed effect</em> emphasizes the existence of both of the individual effect <span>$\alpha_i$</span> and the inefficiency effect <span>$u_{it}$</span> in the model, both of distinct interpretations.</p><p>The challenge of estimating such a model is the incidental parameters problem arising from <span>$\alpha_i$</span>. For a linear panel data model, it is common to get rid of <span>$\alpha_i$</span> before estimation by first-differencing or within-transforming the model. This approach, however, is thought to be infeasible to the above panel SF model because we could not derive the closed-form likelihood function after the model transformation. It was later proven to be not true (see Chen, Schmidt, and Wang 2014).</p><p>Let&#39;s assume we have a panel dataset containing the production data of <span>$N$</span> farmers at the annual frequency for <span>$T$</span> years. We could have <span>$T$</span> to be different across farmers, i.e., <span>$T_i$</span>. We assume the dataset is named <code>df</code> and is <a href="ex_detail.html#useDataFrame">in the DataFrame format</a> and has the following column names (<em>aka</em> variables):</p><ul><li><code>y</code>: production output,</li><li><code>x1</code>, <code>x2</code>, <code>x3</code>: production input,</li><li><code>z1</code>, <code>z2</code>: factors that may affect production efficiency,</li><li><code>_cons</code>: a constant variable with values equal to 1,</li><li><code>yr</code>: year of production,</li><li><code>id</code>: individual farmer&#39;s identification number.</li></ul><p><br/></p><p>First, call in the main packages.</p><pre><code class="language-julia hljs">using SFrontiers
using CSV, DataFrames</code></pre><h4 id="TFE-with-dummy-variables-([Greene-2005,-Wang-2003](@ref-literature))"><a class="docs-heading-anchor" href="#TFE-with-dummy-variables-([Greene-2005,-Wang-2003](@ref-literature))">TFE with dummy variables (<a href="index.html#literature">Greene 2005, Wang 2003</a>)</a><a id="TFE-with-dummy-variables-([Greene-2005,-Wang-2003](@ref-literature))-1"></a><a class="docs-heading-anchor-permalink" href="#TFE-with-dummy-variables-([Greene-2005,-Wang-2003](@ref-literature))" title="Permalink"></a></h4><p>This approach simply uses dummy variables to estimate <span>$\alpha_i$</span>, <span>$i=1,\ldots,N$</span>. Thus, it can be estimated using  <a href="ex_cross.html#crosssectional">cross-sectional models</a> by adding dummy variables in the <code>frontier()</code> equation. To generate dummy variables from <code>id</code> in the original DataFrame, one may try <a href="https://stackoverflow.com/questions/64565276/julia-dataframes-how-to-do-one-hot-encoding">this method</a>:</p><pre><code class="language-julia hljs">df = CSV.read(&quot;panel_example.csv&quot;, DataFrame; header=1, delim=&quot;,&quot;)
df[!, :_cons] .= 1.0

uid = unique(df.id);
df = transform(df, @. :id =&gt; ByRow(isequal(uid)) .=&gt; Symbol(:dummy, uid))</code></pre><p>We may want to see what is inside the data now.</p><pre><code class="language-julia hljs">julia&gt; describe(df)
106×8 DataFrame
│ Row │ variable │ mean      │ min      │ median     │ max     │ nunique │ nmissing │ eltype   │
│     │ Symbol   │ Float64   │ Real     │ Float64    │ Real    │ Nothing │ Nothing  │ DataType │
├─────┼──────────┼───────────┼──────────┼────────────┼─────────┼─────────┼──────────┼──────────┤
│ 1   │ id       │ 50.5      │ 1        │ 50.5       │ 100     │         │          │ Int64    │
│ 2   │ time     │ 3.5       │ 1        │ 3.5        │ 6       │         │          │ Int64    │
│ 3   │ y        │ 0.425722  │ -3.76222 │ 0.400012   │ 3.66662 │         │          │ Float64  │
│ 4   │ x1       │ 0.510121  │ -2.41952 │ 0.517722   │ 3.79116 │         │          │ Float64  │
│ 5   │ x2       │ -0.019732 │ -3.09178 │ 0.00775225 │ 2.99767 │         │          │ Float64  │
│ 6   │ _cons    │ 1.0       │ 1.0      │ 1.0        │ 1.0     │         │          │ Float64  │
│ 7   │ dummy1   │ 0.01      │ 0        │ 0.0        │ 1       │         │          │ Bool     │
│ 8   │ dummy2   │ 0.01      │ 0        │ 0.0        │ 1       │         │          │ Bool     │
⋮
│ 98  │ dummy92  │ 0.01      │ 0        │ 0.0        │ 1       │         │          │ Bool     │
│ 99  │ dummy93  │ 0.01      │ 0        │ 0.0        │ 1       │         │          │ Bool     │
│ 100 │ dummy94  │ 0.01      │ 0        │ 0.0        │ 1       │         │          │ Bool     │
│ 101 │ dummy95  │ 0.01      │ 0        │ 0.0        │ 1       │         │          │ Bool     │
│ 102 │ dummy96  │ 0.01      │ 0        │ 0.0        │ 1       │         │          │ Bool     │
│ 103 │ dummy97  │ 0.01      │ 0        │ 0.0        │ 1       │         │          │ Bool     │
│ 104 │ dummy98  │ 0.01      │ 0        │ 0.0        │ 1       │         │          │ Bool     │
│ 105 │ dummy99  │ 0.01      │ 0        │ 0.0        │ 1       │         │          │ Bool     │
│ 106 │ dummy100 │ 0.01      │ 0        │ 0.0        │ 1       │         │          │ Bool     │</code></pre><p>This approach may be easier to carry out using <strong>SFrontiers</strong>&#39;s <a href="@id matrixinput">matrix-input method</a> in order to avoid manually inputting the dummy variable names which are quite many.</p><pre><code class="language-julia hljs">xvar = Matrix(df[:, [:x1, :x2]])
alldummy = Matrix(df[:, 8:106]) # skip the first dummy to avoid multicollinearity
xMat = hcat(xvar, alldummy) # combine all of the frontier var
yMat = Matrix(df[:, [:y]])
cMat = Matrix(df[:, [:_cons]])

sfmodel_spec(sftype(prod), sfdist(half),  
             depvar(yMat), 
             frontier(xMat), 
             σᵤ²(cMat),
             σᵥ²(cMat))</code></pre><p>The rest of the estimation procedures is the same as in other models. In addition to the computational problem (having to estimate a large number of parameters), the approach suffers from the incidental parameters problem (Wang and Ho 2010). The estimates are consistent only when <span>$T$</span> is large (Greene 2005).</p><p><br/></p><h4 id="TFE-with-skew-normal-approach-([Chen,-Schmidt,-and-Wang-2014](@ref-literature))"><a class="docs-heading-anchor" href="#TFE-with-skew-normal-approach-([Chen,-Schmidt,-and-Wang-2014](@ref-literature))">TFE with skew-normal approach (<a href="index.html#literature">Chen, Schmidt, and Wang 2014</a>)</a><a id="TFE-with-skew-normal-approach-([Chen,-Schmidt,-and-Wang-2014](@ref-literature))-1"></a><a class="docs-heading-anchor-permalink" href="#TFE-with-skew-normal-approach-([Chen,-Schmidt,-and-Wang-2014](@ref-literature))" title="Permalink"></a></h4><p>The authors use results from the closed skew-normal literature and derive the model&#39;s closed-form likelihood function after first-differencing or within transforming the model. The model id is <code>TFE_CSW2014</code>.</p><pre><code class="language-julia hljs">sfmodel_spec(sfpanel(TFE_CSW2014), sftype(prod), sfdist(half),
             @timevar(yr), @idvar(id),
             @depvar(y), 
             @frontier(x1, x2, x3), 
             @σᵤ²(_cons),
             @σᵥ²(_cons))</code></pre><ul><li>The user does not have to first-difference or within-transform the data; the program will perform the transformation.</li><li><code>_cons</code> cannot be included in <code>@frontier()</code>, because <span>$\alpha_i$</span> is a fixed parameter, and including <code>_cons</code> in addition to a full set of <span>$\alpha_i$</span> would cause multicollinearity.</li><li>The model does not support exogenous determinants of inefficiency.</li><li><code>sfdist()</code> only supports <code>half</code>.</li></ul><p><br/></p><h4 id="TFE-with-scaling-property-and-inefficiency-determinants-([Wang-and-Ho-2010](@ref-literature))"><a class="docs-heading-anchor" href="#TFE-with-scaling-property-and-inefficiency-determinants-([Wang-and-Ho-2010](@ref-literature))">TFE with scaling property and inefficiency determinants (<a href="index.html#literature">Wang and Ho 2010</a>)</a><a id="TFE-with-scaling-property-and-inefficiency-determinants-([Wang-and-Ho-2010](@ref-literature))-1"></a><a class="docs-heading-anchor-permalink" href="#TFE-with-scaling-property-and-inefficiency-determinants-([Wang-and-Ho-2010](@ref-literature))" title="Permalink"></a></h4><p>Wang and Ho (2010) propose a model where the <span>$u_{it}$</span> is modeled as</p><p class="math-container">\[\begin{aligned}
  u_{it} &amp; = h(z_{it}; \delta)\cdot u_i^*,\\
  u_i^* &amp; \sim N^+(\mu, \sigma_u^2),
\end{aligned}\]</p><p>where</p><p class="math-container">\[\begin{aligned}
   h(z_{it}; \delta) &amp; = \exp(z_{it}\delta),\\
   \sigma_u^2 &amp; = \exp(c_u).
\end{aligned}\]</p><p>Both of <span>$\mu$</span> and <span>$\sigma_u^2$</span> are constant, and <span>$\mu$</span> may equal 0 for a half-normal assumption.</p><p>The specification has two advantages: (1) The closed-form likelihood function can be derived using the conventional method. (2) The model can easily accommodate exogenous determinants of inefficiency. The model is <code>TFE_WH2010</code>.</p><pre><code class="language-julia hljs">sfmodel_spec(sfpanel(TFE_WH2010), sftype(prod), sfdist(trun),
             @timevar(yr), @idvar(id),
             @depvar(y), 
             @frontier(x1, x2, x3), 
             @μ(_cons),
             @hscale(z1, z2),                # h(.) function
             @σᵤ²(_cons),
             @σᵥ²(_cons))</code></pre><ul><li>The user does not have to first-difference or within-transform the data; the program will perform the transformation.</li><li><code>_cons</code> cannot be included in <code>@frontier()</code>, because <span>$\alpha_i$</span> is a fixed parameter.</li><li>Giving <code>sfdist(half)</code> and omitting <code>@μ()</code> will estimate the model with the half-normal distribution.</li></ul><p><br/></p><h2 id="Panel-True-Random-Effect-Model"><a class="docs-heading-anchor" href="#Panel-True-Random-Effect-Model">Panel True Random Effect Model</a><a id="Panel-True-Random-Effect-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Panel-True-Random-Effect-Model" title="Permalink"></a></h2><p>The model is attributed to <a href="index.html#literature">Greene (2005)</a>. It assumes <span>$\alpha_i$</span> to be a value from a random variable. We assume that </p><p class="math-container">\[\begin{aligned}
  \alpha_i  &amp;  \sim N(0, \sigma_a^2),\\
  \sigma_a^2  &amp; = \exp(c_a),
\end{aligned}  \]</p><p>where <span>$c_a \in R$</span> is a constant. The model id is <code>TRE</code>.</p><pre><code class="language-julia hljs">sfmodel_spec(sfpanel(TRE), sftype(prod), sfdist(half),
             @timevar(yr), @idvar(id),
             @depvar(y), 
             @frontier(x1, x2, _cons), 
             @σₐ²(_cons),
             @σᵤ²(_cons),
             @σᵥ²(_cons))</code></pre><ul><li>The constant <code>_cons</code> is included in <code>@frontier()</code> since <span>$\alpha_i$</span> is random.</li><li>Giving <code>sfdist(trun)</code> and <code>@μ(_cons)</code> will estimate the model with the truncated-normal distribution.</li></ul><p><br/></p><h2 id="Panel-Time-Decay-Model"><a class="docs-heading-anchor" href="#Panel-Time-Decay-Model">Panel Time Decay Model</a><a id="Panel-Time-Decay-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Panel-Time-Decay-Model" title="Permalink"></a></h2><p>The model is attributed to <a href="index.html#literature">Battese and Coelli (1992)</a>.</p><p class="math-container">\[\begin{aligned}
  &amp; y_{it}  = \alpha_0 +  x_{it} \beta + \epsilon_{it},\\
  &amp; \epsilon_{it}  = v_{it} - u_{it},\\
  &amp; v_{it} \sim N(\mu_i, \sigma_v^2),   \\
  &amp; u_{it} \sim G(t) u_i^*, \quad u_i^* \sim N^+(0, \sigma_u^2).
\end{aligned} \]</p><p>where </p><p class="math-container">\[\begin{aligned}
  G(t) &amp; = \exp[\gamma (t_i − T_i)],\\
  \sigma_u^2 &amp; = \exp(c_u).
\end{aligned}  \]</p><p>In the specification, <span>$G(t)$</span> is a function of time <span>$t_i$</span>, and <span>$T_i = \mathrm{max}(t_i)$</span> is fixed for an individual. A positive estimate of <span>$\gamma$</span> thus indicates a decreasing of inefficiency over time (i.e., <em>time decay</em>). The <span>$\mu_i$</span> can be a function of individual specific variable or a constant (<span>$\mu_i = \mu$</span>). </p><p>Note that the frontier function has an overall intercept <span>$\alpha_0$</span> but there is no individual effect <span>$\alpha_i$</span> in the model, and so it does not belong to the class of true-fixed or true-random effect model. The model is <code>TimeDecay</code>.</p><p>Kumbhakar and Wang (2005) use a variant of the model to study growth convergence of a panel of countries, where they have <span>$\mu_i$</span> as the country&#39;s initial capital stock per capita when data began in the 1960s. We assume <span>$w$</span> to be such a variable in the following example.</p><pre><code class="language-julia hljs">using Statistics, DataFramesMeta  # helps to get `yearT_i = yr_i - max(yr_i)`

# assume `df` is already loaded 
gdf = groupby(df, :id)               # info of data grouping
df = @transform(gdf, yearT = :yr .-  maximum(:yr))   # create yearT


sfmodel_spec(sfpanel(TimeDecay), sftype(prod), sfdist(trun),
             @timevar(yr), @idvar(id),
             @depvar(y), 
             @frontier(x1, x2, x3, _cons), 
             @μ(w, _cons),
             @gamma(yearT),              # the G(.) function
             @σᵤ²(_cons),
             @σᵥ²(_cons))</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="ex_cross.html">« cross-sectional models</a><a class="docs-footer-nextpage" href="api.html">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Sunday 29 August 2021 00:54">Sunday 29 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
